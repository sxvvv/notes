## triton 基础

### 1. triton的定义

Triton 既是语言，也是编译器。

#### 1.1 三大组件
- Intermediate Language（中间语言）：基于Python的DSL
- tiled Neural Network Compute（分块神经网络计算）： 面向GPU体系特点，自动分析和实施神经网络计算的分块
- Compiler（编译器）

#### 1.2 triton 特性
1. 粒度为 block(tile)：更关心 block（即 SM 和 CUDA 的 block 不完全一样），而不是 grid、block、thread 这样严格而又复杂的线程组织结构。
2. 优化 Pass: 借助一系列的优化 Pass，它可以达到和 cuBLAS 等算子库接近的水平。
3. 和 pytorch 无缝衔接: 输入是 torch 张量指针。

**triton 算子和 torch eager 算子区别：**

1. triton 的操作对象是张量指针，torch 的输入是张量视图。
  - 张量指针：关心张量布局，使用偏移量访问存储。
  - 张量视图：关心张量形状，可能在储存上不连续。

2. 通用算子领域，优化的 triton 算子性能可和 cuda 算子持平；在自定义算子、融合算子领域，短期内 triton 算子性能能更高。
